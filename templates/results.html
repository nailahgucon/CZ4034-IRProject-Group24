{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1>Results</h1>
</div>
<div class="form">
  <form action="/filter" method="GET" style="
  display: flex;
  align-items: center;
  justify-content: space-evenly;
">
    <label for="startDate">Filter by Date:</label>
    <input type="date" id="startDate" name="startDate">
    <label for="endDate"> to </label>
    <input type="date" id="endDate" name="endDate">
    <br><br>

    <label for="category">Filter by Category:</label>
    <select id="category" name="category">
      <option value="">Select a rating</option>
      <option value="Hotel">Hotel</option>
      <option value="Eatery">Eatery</option>
    </select>
    <br><br>

    <label for="star">Filter by Star:</label>
    <select id="star" name="star">
      <option value="">Select a star</option>
      <option value="1">1 star</option>
      <option value="2">2 stars</option>
      <option value="3">3 stars</option>
      <option value="4">4 stars</option>
      <option value="5">5 stars</option>
    </select>
    <br><br>

    <label for="rating">Filter by Rating:</label>
    <select id="rating" name="rating">
      <option value="">Select a rating</option>
      <option value="1">1 star</option>
      <option value="2">2 stars</option>
      <option value="3">3 stars</option>
      <option value="4">4 stars</option>
      <option value="5">5 stars</option>
    </select>
    <br><br>
    
    <input type="submit" value="Apply Filters">
    <button type="button" onclick="resetFilter()">Clear Filters</button>
  </form>
</div>
<div class="table-responsive">
  <table class="table table-striped table-sm table-bordered">
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Category</th>
        <th>Style</th>
        <th>Star</th>
        <th>Date</th>
        <th>Rating</th>
        <th>ReviewTitle</th>
        <th>Review</th>
      </tr>
    </thead>

    <tbody>

      {% for result in docs %}
      <tr>
        <td class="align-middle">{{loop.index}}</td>
        <td class="align-middle">{{result.Name}}</td>
        <td class="align-middle">{{result.Category}}</td>
        <td class="align-middle">{{result.Style}}</td>
        <td class="align-middle">{{result.Star}}</td>
        <td class="align-middle">{{result.Date}}</td>
        <td class="align-middle">{{result.Rating}}</td>
        <td class="align-middle">{{result.ReviewTitle}}</td>
        <td class="align-middle">{{result.Review}}</td>       
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-end">

    <li class="page-item">
      <!-- First button -->
      <a class="page-link" href={{url_for('pagination',page=1 )}} aria-label="First page">
        <span aria-hidden="true">&laquo;</span>
        <span class="sr-only">First page</span>
      </a>
    </li>

    <li class="page-item">
      <!-- Previous button -->
      {% if current_page-1<1 %} <a class="page-link" href="#" aria-label="Previous">
        <span aria-hidden="true">&lt;</span>
        <span class="sr-only">Previous</span>
        </a>
        {% else %}
        <a class="page-link" href={{url_for('pagination',page=current_page-1 )}} aria-label="Previous">
          <span aria-hidden="true">&lt;</span>
          <span class="sr-only">Previous</span>
        </a>
        {% endif %}
    </li>

    {% for page in range(total_pages) %}
    <li class="page-item"><a class="page-link" href={{url_for('pagination',page=loop.index)}}>{{loop.index}}</a></li>
    {% endfor %}

    <li class="page-item">
      <!-- Next button -->
      {% if current_page+1>total_pages %}
      <a class="page-link" href="#" aria-label="Next">
        <span aria-hidden="true">&gt;</span>
        <span class="sr-only">Next</span>
      </a>
      {% else %}
      <a class="page-link" href={{url_for('pagination',page=current_page+1 )}} aria-label="Next">
        <span aria-hidden="true">&gt;</span>
        <span class="sr-only">Next</span>
      </a>
      {% endif %}
    </li>

    <li class="page-item">
      <!-- Last button -->
      <a class="page-link" href={{url_for('pagination',page=total_pages )}} aria-label="Last page">
        <span aria-hidden="true">&raquo;</span>
        <span class="sr-only">Last page</span>
      </a>
    </li>
  </ul>
</nav>

<script>
  
  function resetFilter() {
    window.location.href = "/pagination?page=1";
  }
  
</script>

{% endblock %}
